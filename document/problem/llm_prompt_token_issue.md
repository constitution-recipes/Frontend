# 여러 기능 지원 프리프롬프트 도입에 따른 토큰 증가 및 비용 문제 해결 경험

## 문제 발생 이름
여러가지 기능을 지원하는 프리프롬프트를 넣다 보니 토큰이 늘어나 비용 증가

## 문제 발생 내용 요약
- 다양한 기능(예: 체질 진단, 취향 분석, 레시피 추천, 피드백 등)을 한 번에 지원하는 프리프롬프트를 LLM에 입력하다 보니, 프롬프트의 토큰 수가 급격히 증가
- 이로 인해 LLM 호출 비용이 예상보다 크게 증가하고, 응답 속도도 저하되는 문제가 발생

## 원인
- 여러가지 기능을 지원하는 프리프롬프트를 한 번에 넣다 보니, 프롬프트 길이가 길어져 토큰이 늘어나고 비용이 증가함
- 각 기능별로 필요한 정보와 지시사항이 모두 포함되어, 불필요하게 중복되는 내용도 많았음

## 해결
- **기본 베이스 프롬프트**를 먼저 설계(공통 안내, 역할, 톤 등)
- 각 기능(체질 진단, 취향 분석, 레시피 추천 등)에 맞는 **기능별 프롬프트**를 별도로 제작
- 실제 LLM 호출 시, 필요한 기능에 따라 베이스 프롬프트와 해당 기능 프롬프트만 동적으로 합쳐서 사용
- 여러 기능이 동시에 필요한 경우, LLM을 활용해 각 기능 프롬프트를 조합/튜닝하여 최적의 프리프롬프트를 생성
- 최종적으로, 프롬프트 길이와 토큰 수를 최소화하면서도, 각 기능의 품질을 유지할 수 있었음

## 실제 적용 경험 및 효과
- 프롬프트 구조를 모듈화/동적 조합 방식으로 변경한 후, 평균 프롬프트 토큰 수가 30% 이상 감소
- LLM 호출 비용이 크게 절감되고, 응답 속도도 개선됨
- 기능별 프롬프트를 독립적으로 관리할 수 있어, 새로운 기능 추가/수정 시 유지보수성이 향상됨
- 실제 서비스 운영 중, 프롬프트 최적화로 월간 LLM API 비용이 절반 가까이 줄어드는 효과를 경험함

## 결론 및 어필 포인트
- 다양한 기능을 지원하는 프리프롬프트를 무분별하게 확장할 경우, 토큰 증가와 비용 폭증이라는 실질적 문제를 겪음
- 이를 해결하기 위해 프롬프트를 기능별로 분리/조합하고, LLM 튜닝을 통해 최적화된 프리프롬프트를 제작함으로써, 비용과 품질을 모두 잡은 경험을 쌓음
- 이 경험을 통해, 실제 LLM 서비스 운영에서 프롬프트 설계와 비용 최적화의 중요성을 체감하고, 효과적으로 문제를 해결한 사례임을 어필할 수 있음 